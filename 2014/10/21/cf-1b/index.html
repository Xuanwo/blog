<!doctype html><html><head><title>Codeforces Beta Round 1 B Spreadsheets</title><meta charset=utf-8><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="A blog maintained by an interesting programmer."><meta name=keywords content="Technology,Code,Program,Linux,"><meta name=author content="Xuanwo"><meta property="og:title" content="Codeforces Beta Round 1 B Spreadsheets"><meta property="og:description" content="A blog maintained by an interesting programmer."><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="https://xuanwo.io/2014/10/21/cf-1b/"><link rel="shortcut icon" href=/favicon.ico><link rel=stylesheet href=https://xuanwo.io/css/main.min.be107db044369d658c06efdc8f7f5462fda2b704c0a580ab8c227b3dad6ac109.css integrity="sha256-vhB9sEQ2nWWMBu/cj39UYv2itwTApYCrjCJ7Pa1qwQk="><script data-ad-client=ca-pub-8380875817494486 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><link href=http://gmpg.org/xfn/11 rel=profile><meta name=generator content="Hugo 0.68.3"></head><body><nav class=nav><div class=nav-container><div class=brand><a href=https://xuanwo.io>Xuanwo's Blog</a></div><div class=links><a class=main-nav-link href=/about/>关于我</a>
<a class=main-nav-link href=/posts/>文章</a></div></div></nav><main id=main-content><article class="single container"><header class=single-header><div class=flex><h1>Codeforces Beta Round 1 B Spreadsheets</h1><div class=post-meta><time class=date datetime=2014-10-21T14:35:33.000+00:00 itemprop=datePublished>2014-10-21</time>
/
<span><a href=#disqus_thread class=comment-link>Comments</a></span></div><div class=tag-container></div></div></header><div class=post><h2 id=题目>题目</h2><p>源地址：</p><p><a href=http://codeforces.com/contest/1/problem/B>http://codeforces.com/contest/1/problem/B</a></p><h1 id=理解>理解</h1><p>大水题一道，不过我坑了很久，实在是代码功底太弱。
题意非常简单，给出两种表格的坐标体系，要你进行相互转化，本质上是一道26进制转化类的题目。
我遇到的坑基本上分为两类，一个是在判断当前输入的字符串属于何种类型，第二是在具体实现过程中的BUG。
首先，讲一讲判断的过程。我另外写了一个判断的函数，一开始想的比较简单，只要判断第二个是不是字符，就OK。挂在了Test 2，错误样例是<code>A1</code>。然后就在思考，这两种坐标体系的根本不同到底在哪里。实际上，RXCY体系中一定有字符R和C，R和C之间必定会有一个数字。从这一点出发，重写了一遍judge函数，总算是搞定了问题。
其次，来看一下在具体的实现过程中的BUG。这一次挂在了Test 6，一个总共有1000个的输入= =，错误的样例是<code>R228C494</code>和<code>R98C688</code>。观察之后发现，问题出在进退位上，因为在A—Z的体系中，实际上是没有代表&rsquo;0'这个字符的，所以，当R或者C坐标上出现整除的时候，就会发现本应出现&rsquo;Z'的地方，出现了字符&rsquo;@'。不过在挂了这么多发之后，偷懒直接进行了特判，当&rsquo;Z'出现字符串末尾，也就是c%26==0时，直接指定它为&rsquo;Z&rsquo;；当Z出现在字符串最前方时，直接在输出中过滤。
然后= =，A了。</p><h1 id=代码>代码</h1><pre><code>
#include &lt;cstdio&gt;
#include &lt;cstdlib&gt;
#include &lt;cstring&gt;
#include &lt;cmath&gt;
#include &lt;ctime&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;string&gt;
#include &lt;vector&gt;
#include &lt;deque&gt;
#include &lt;list&gt;
#include &lt;set&gt;
#include &lt;map&gt;
#include &lt;stack&gt;
#include &lt;queue&gt;
#include &lt;numeric&gt;
#include &lt;iomanip&gt;
#include &lt;bitset&gt;
#include &lt;sstream&gt;
#include &lt;fstream&gt;
#define debug &quot;output for debug\n&quot;
#define pi (acos(-1.0))
#define eps (1e-8)
#define inf (1&lt;&lt;28)
#define ll long long int
using namespace std;
#define MAXN 40000

int t;
char str[MAXN],ans[MAXN];

bool judge(char str[])
{
    string tmp=str;
    if(tmp.find('C')&gt;=tmp.size()||tmp.find('R')&gt;=tmp.size()||tmp.find('C')&lt;tmp.find('R'))    return true;
    else
    {
        for(int i=tmp.find('R'); i&lt;=tmp.find('C'); i++)
        {
            if(str[i]&lt;='9') return false;
        }
        return true;
    }
    return false;
}

void exceltorxcy(char str[])
{
    int r=0,c=0;
    int len=strlen(str);
    for(int i=0; i&lt;len; i++)
    {
        if(str[i]&gt;='A'&amp;&amp;str[i]&lt;='Z')
        {
            c=c*26+str[i]-'A'+1;
        }
        else
        {
            r=r*10+str[i]-'0';
        }
    }
    printf(&quot;R%dC%d\n&quot;, r,c);
}

void rxcytoexcel(char str[])
{
    int i,j,c=0,r=0;
    int len=strlen(str);
    for(i=0; i&lt;len; i++)
    {
        if(str[i]=='C')    break;
        if(str[i]&gt;='0'&amp;&amp;str[i]&lt;='9')
        {
            r=r*10+str[i]-'0';
        }
    }
    for(j=i; j&lt;len; j++)
    {
        if(str[j]&gt;='0'&amp;&amp;str[j]&lt;='9')
        {
            c=c*10+str[j]-'0';
        }
    }
    i=0;
    while(c/26!=0)
    {
        if(c%26==0)
        {
            ans[i]='Z';
            c-=1;
        }
        else
        {
            ans[i]=c%26+'A'-1;
        }
        c/=26;
        i++;
    }
    ans[i]=c%26+'A'-1;
    for(; i&gt;=0; i--)
    {
        if(ans[i]!='@')
            printf(&quot;%c&quot;, ans[i]);
    }
    printf(&quot;%d\n&quot;, r);
}

int main(int argc, char const *argv[])
{
    scanf(&quot;%d&quot;, &amp;t);
    while(t--)
    {
        memset(ans,0,sizeof(ans));
        scanf(&quot;%s&quot;, str);
        if(judge(str))  exceltorxcy(str);
        else    rxcytoexcel(str);
    }
    return 0;
}

/*
R228C494
RZ228
R98C688

**/


</code></pre><h1 id=更新日志>更新日志</h1><ul><li>2014年10月21日 已AC。</li></ul></div><div id=disqus_thread></div><script type=application/javascript async>let disqus_config=function(){this.page.identifier='\/2014\/10\/21\/cf-1b\/';this.page.title='Codeforces Beta Round 1 B Spreadsheets';this.page.url='https:\/\/xuanwo.io\/2014\/10\/21\/cf-1b\/';};(function(){let d=document,s=d.createElement('script');s.async=true;s.src='//only0god.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script></article></main><footer class="footer container"><a class=main-nav-link href=/categories/>分类</a>
<a class=main-nav-link href=/tags/>标签</a>
<a class=main-nav-link href=/series/>专题</a>
<a class=main-nav-link href=/blogroll/>友链</a>
<a class=main-nav-link href=/index.xml>订阅</a>
<script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-51515330-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></footer></body></html>